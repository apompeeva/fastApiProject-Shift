# Salary

## Техническое заданиие 
Реализуйте REST-сервис просмотра текущей зарплаты и даты следующего
повышения. Из-за того, что такие данные очень важны и критичны, каждый
сотрудник может видеть только свою сумму. Для обеспечения безопасности, вам
потребуется реализовать метод где по логину и паролю сотрудника будет выдан
секретный токен, который действует в течение определенного времени. Запрос
данных о зарплате должен выдаваться только при предъявлении валидного токена.

## Реализованы необязательные технические требования
- зависимости зафиксированы менеджером зависимостей **poetry**
- написаны тесты с использованием **pytest**
- реализована возможность собирать и запускать контейнер с сервисом в **Docker**

## Стек
- Python
- FastAPI
- PostgreSQL
- fastapi-users
- Sqlalchemy
- Uvicorn
- Alembic
- Poetry
- pytest-asyncio

## Инструкция по запуску проекта локально

1. Клонировать репозиторий.
    - клонировать с SSH
    ```bash
    git clone git@gitlab.com:python_projects9153019/salary_info_api.git
    ```
    - клонировать с HTTPS
    ```bash
    git clone https://gitlab.com/python_projects9153019/salary_info_api.git
    ```
2. Cоздать и активировать виртуальное окружение, установить зависимости.

    - установить poetry
    - настроить и создать виртуальное окружение в папке проекта, установить зависимости, активировать виртуальное окружение   
    ```bash
    cd salary
    poetry config virtualenvs.in-project true
    poetry install
    poetry shell

    ```
3. В корневой директории cоздать .env файл по следующему шаблону:

    ```
   SECRET = ''
   EXPIRATION_TIME = ''

   #Данные для подключения к бд
   DB_HOST=''
   DB_PORT=''
   DB_NAME=''
   DB_USER=''
   DB_PASS=''

   #Данные для подключения к тестовой бд
   DB_HOST_TEST = ''
   DB_PORT_TEST = ''
   DB_NAME_TEST = ''
   DB_USER_TEST = ''
   DB_PASS_TEST = ''



   FIRST_SUPERUSER_EMAIL = "admin@example.com"
   FIRST_SUPERUSER_PASSWORD = "admin"

    ```
4. Применить миграции
    ```bash
    alembic upgrade head
    ```
5. Запустить проект
    ```bash
    uvicorn app.main:app --reload
    ```

## Взаимодействие с проектом 

При первом запуске проекта автоматически создается суперпользователь (администратор), от имени которого после авторизации можно вносить информациюю о заработной плате сотрудников.

Взаимодействовать с сервисом можно через 
* Swagger, в котором задокументированы возможности API и примеры запросов, перейдя по адресу [http://127.0.0.1:8000/docs](http://127.0.0.1:8000/docs)
* [Postman](https://www.postman.com/) - сервис для создания, тестирования, документирования, публикации и обслуживания API



## Тестирование
Для запуска тестов в корневой директории проекта выполнить:

```bash
pytest tests

```


